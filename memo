서버간 통신보안을 위한 생각

main server (SNS)
sub server(Img Server)

두 서버의 기본틀

Main 에서 이미지를 저장, 로딩할때 발생하는 트래픽 최소화를 위한 방법
메인서버는 cafe24 플랫폼을 통하여 호스팅 되어지고 있으므로 일간 트래픽에 제한이 있어 직접적인 이미지를 업로드하게되면
트래픽 낭비가심함
따라서 외부서버 즉 img 서버를 구축하여 이를 해결 하고자함

img 트래픽을 분산시키기 위해
sub server를 restapi 틀로 만들고자함
아무에게나 업로드, 삭제를 허용하면 안되므로 특정 키를 통한 인증방식 사용

1. 사용자가 이미지를 업로드 하고자하면 main server에 토큰요청 main server는 seb server에 토큰요청
mainserver가 return 한 토큰을 가지고 통신 시도 트큰이 일치하는 경우에 업로드 삭제 허용

2. 특정 아이피에서의 접근만 허용하는 방법 (2중 보안)

3. 토큰 value 갱신 시나리오
    사용자가 토큰을 요청할때마다 토큰을 발급하고 이는 1회성으로 이용됨
    토큰이 일치하면 토큰을 폐기하고
    일치하지 않을시 발급된 토큰은 5분이 지나면 폐기됨.

4. 사용자가 이미지를 로드 할때의 보안
    메인서버와 서브서버는 같은 세션을 공유..?
    는 세션 클러스터링이라고 한다.
    --redis 이용

